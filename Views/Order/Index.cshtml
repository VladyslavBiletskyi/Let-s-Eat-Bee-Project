@model List<Let_s_Eat_Bee_Project.Models.Order>
@{
    ViewBag.Title = "Index";
}
@*<h2>Index</h2>
    @foreach (var item in Model)
    {
        <br />
        @item.Id
        <br />
        @item.Address
        <br />
        @item.CompleteDateTime
        <br />
    }*@

<div class="block-order">
    <div class="container">
        <div id="create-block">
            <h3>View Orders</h3>

            <form>
                <div class="row sort-and-filter">
                    <div class="col s12 m3">
                        <div class="input-field col s12">
                            <select id="sort">
                                <option value="0" selected>No sorting</option>
                                <option value="1">The earliest</option>
                                <option value="2">The latest</option>
                            </select>
                         </div>
                        </div>
                    <div class="col s12 m7">
                        <div class="input-field col s6">
                            <label for="startdate">Show orders from</label>
                            <input type="date" class="datepicker" id="startdate">
                        </div>
                        <div class="input-field col s6">
                            <label for="enddate">To</label>
                            <input type="date" class="datepicker" id="enddate">
                        </div>
                    </div>
                    <div class="col s12 m2">
                        <div class="input-field" style="padding-top: 8px;">
                            <button type="button" class="waves-effect waves-light btn #4a148c purple darken-3" id="confirm_filter">Confirm</button>
                        </div>
                    </div>
                   
                </div>

            </form>

            <!--карточки - в рядах. в каждом ряду максимум 3 карточки-->
            <div class="row">
                @for (int i = (ViewBag.Page - 1) * 6; i < Model.Count && i < (ViewBag.Page * 6) - 3; i++)
                {
                    <div class="col s12 m4">
                        <div class="card #4a148c purple darken-3 order-card">
                            <div class="card-content white-text">
                                <span class="card-title">@Model[i].CreationDateTime</span>
                                <p>Address: @Model[i].Address </p>
                                <p>Description: @Model[i].Joinings.First().Text</p>
                            </div>
                            <div class="card-action">
                                <a href="#join-order">Join</a>
                                @Html.ActionLink("View details","Detail","Order",new { @Model[i].Id },null)
                            </div>
                        </div>
                    </div>
                }
            </div>
            <div class="row">
                @for (int i = ((ViewBag.Page - 1) * 6) + 3; i < Model.Count && i < (ViewBag.Page * 6); i++)
                {
                    <div class="col s12 m4">
                        <div class="card #4a148c purple darken-3">
                            <div class="card-content white-text">
                                <span class="card-title">@Model[i].CreationDateTime</span>
                                <p>Address: @Model[i].Address </p>
                                <p>Description: @Model[i].Joinings.First().Text</p>
                            </div>
                            <div class="card-action">
                                <a href="#join-order?id=@Model[i].Id">Join</a>
                            </div>
                        </div>
                    </div>
                }
                @if (ViewBag.Page > 1)
                {
                    @Html.ActionLink("Previous page", "Index", "Order", new { page = ViewBag.Page -1 }, null)
                }
                @if ((ViewBag.Page * 6) < Model.Count)
                {
                    @Html.ActionLink("Next page", "Index", "Order", new { page = ViewBag.Page+1 }, null)
                }
            </div>

            <!-- Modal Structure -->
            <div id="join-order" class="modal">
                @using (Html.BeginForm("Join", "Order", new { id = Request.QueryString["id"] }))
                    {
                 <div class="modal-content">
                    <h4>Join Order</h4>
                    @if (!User.Identity.IsAuthenticated)
                    {                        
                        <div class="row">
                            <div class="input-field col s12">
                                <label for="first_name">First Name</label>
                                <input type="text" id="first_name" name="UserFirstName" required />                            
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <label for="last_name">Last Name</label>
                                <input type="text" id="last_name" name="UserLastName" required />
                            </div>
                        </div>
                    }
                        <div class="row">
                            <div class="input-field col s12">
                                <label for="text_of_join">Text</label>
                                <input type="text" id="text_of_join" name="Text" required />
                            </div>
                        </div>
                </div>
                <div class="modal-footer">
                    <center>
                        <button id="join" class="modal-action modal-close waves-effect waves-green btn-flat">Join</button>
                    </center>
                </div>
                    }
            </div>

        </div>
    </div>
</div>
@if (!User.Identity.IsAuthenticated)
{
    <script type="text/javascript" src="~/Scripts/validateModal.js"></script>
}